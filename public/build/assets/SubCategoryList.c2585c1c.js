import{bD as le,y as ne,Z as ce,i as m,j as de,B as c,o as l,c as k,b as a,w as u,a as n,Y as me,f as h,F as X,s as re,n as $,q as K,t as E,g as w,O as ue,r as i}from"./app.0e502cc5.js";import pe from"./PsButton.bc5ed803.js";import _e from"./PsLabel.3cf95094.js";import fe from"./PsLabelHeader4.fc9d9bf1.js";import be from"./PsIcon.dc31c2db.js";import ge from"./PsInput.e5044849.js";import he from"./PsDropdown.f31a931d.js";import Se from"./CustomCheckbox.baf84324.js";import ye from"./PsBreadcrumb2.00bc7c75.js";import ve from"./PsWarningDialog3.d42b19da.js";import ke from"./PsDropdownSelect.8d0bad23.js";import we from"./PsLazyImage.38e4a2ae.js";import Ce from"./PsRouteLink.8f7df026.js";import Pe from"./PsLoadingDialog.e4058754.js";import Ie from"./PsSuccessDialog2.6772f7b4.js";import xe from"./PsErrorDialog.092191b2.js";import{P as Z}from"./ps_constants.0e2a11f9.js";import{u as Le}from"./AppInfoStore.266a6525.js";import{A as Ae}from"./AppInfoParameterHolder.e24d894d.js";import{u as Ue}from"./SubCategoryStore.60daf9d9.js";import{P as se,b as He}from"./PsApiService.98e573c3.js";import{A as ae}from"./ApiStatus.5720ba0b.js";import{m as Ee}from"./PsSepetetedStore.9a31ac47.js";import{P as Ne}from"./PsValueStore.a232cbb1.js";import{f as ie}from"./index.esm.159b9749.js";import"./PsNotificationBox.8f065d5d.js";import Ve from"./PsContentContainer.26532414.js";import Be from"./PsFrontendLayout.64b287f7.js";import Me from"./PsInputWithRightIcon.f020751b.js";import Te from"./PsNoResult.b11e5131.js";import{P as N}from"./PsUtils.78b0d4de.js";import{_ as De}from"./plugin-vue_export-helper.21dcd24c.js";import"./PsModal.20834757.js";import"./vue-neat-modal.d03c5dee.js";import"./PsLine.4597488d.js";import"./PsLabelTitle.41617619.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";import"./SubCategory.1b4176e0.js";import"./DefaultIcon.e76b39a5.js";import"./ProductStore.279e879d.js";import"./ProductParameterHolder.4354be0b.js";import"./Phone.45f97258.js";import"./Product.29c94914.js";import"./Category.7c65464b.js";import"./ItemCurrency.91c8ce91.js";import"./ItemLocation.d1b92a80.js";import"./ProductRelation.0b376978.js";import"./User.0c3ba1a8.js";import"./RatingDetail.291ad5d1.js";import"./Vendor.d946ee87.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./UserUnReadMessageParameterHolder.181142c1.js";import"./FooterView.1e68f849.js";import"./FooterLinkSection.714178c6.js";import"./PsLink.555685fa.js";import"./PsLabelCaption.a33ce9c4.js";import"./CustomFieldStore.b038b00e.js";import"./PsStore.f4ecabdb.js";import"./PsNavTabBar.634541ec.js";import"./PsIconToggle.5f73bff4.js";import"./PsInputWithLeftIcon.ae1f5479.js";import"./ItemLocationTownshipStore.d4fe0c18.js";import"./LocationParameterHolder.a5eab253.js";import"./PsNavBar.0669b7b7.js";import"./UserStore.ecd89ebd.js";import"./UserListParameterHolder.d110b747.js";import"./auth.esm.925cebae.js";import"./AddToCartStore.3ffc08d4.js";import"./NotificationStore.656ac75f.js";import"./NotiUnRegisterHolder.eefb692e.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";const Fe=Ee(r=>le(`subCategoryScribeStore/${r}`,()=>{const s=ne({value:!1});async function V(S,p){s.value=!0;const C=await se.postSubCategoryScribe(new ae,S,p.toMap());return s.value=!1,C}async function e(S,p){s.value=!0;const C=await se.isUserSubscribed(new ae,S,p);return s.value=!1,C}return{subCategoryScription:V,isUserSubscribed:e,loading:s}}));class Oe{constructor(){this.userId="",this.catId="",this.subCatIds=[]}SubCategoryScribeParameterHolder(){return this.userId="",this.catId="",this.subCatIds=[],this}toMap(){return{user_id:this.userId,cat_id:this.catId,sub_cat_ids:this.subCatIds}}}const Re={name:"SubCategoryListView",components:{PsNoResult:Te,PsButton:pe,PsLabel:_e,PsLabelHeader4:fe,PsIcon:be,PsRouteLink:Ce,PsInput:ge,PsDropdown:he,PsLoadingDialog:Pe,PsErrorDialog:xe,CustomCheckbox:Se,PsSuccessDialog2:Ie,PsBreadcrumb2:ye,PsContentContainer:Ve,PsInputWithRightIcon:Me,Head:ce,PsWarningDialog3:ve,PsDropdownSelect:ke,PsLazyImage:we},props:["query","mobileSetting","backendSetting"],layout:Be,setup(r){var G,ee,oe,te;localStorage.catId="";const s=(G=r.query)==null?void 0:G.cat_id,V=(ee=r.query)==null?void 0:ee.cat_name,e=Ue(),S=Fe(),p=new Oe,_=Ne().getLoginUserId(),P=new Ae;P.userId=_;const W=Le(),A=m(!0),I=m(!1);e.limit=(te=(oe=r.mobileSetting)==null?void 0:oe.default_loading_limit)!=null?te:12;const y=m(),v=m();let U=m(""),B=m(""),H=m(!1),g=m([]),b=m([]);const x=m(),Y=m(),J=[{id:"0",orderBy:"name",orderType:Z.FILTERING__ASC,name:"A to Z"},{id:"1",orderBy:"name",orderType:Z.FILTERING__DESC,name:"Z to A"}];async function Q(){}Q(),e.subCategoryList.data=[],e.paramHolder.catId=s,setTimeout(async()=>{await f()},1e3);function M(t){U.value=t.id,B.value=t.name,e.paramHolder.orderBy=t.orderBy,e.paramHolder.orderType=t.orderType,f()}async function T(){_!=Z.NO_LOGIN_USER?(I.value==!1&&v.value.openModal(c("subcat_subscribe__how_it_works"),c("subcat_subscribe__desc"),c("payment__ok"),()=>{N.log("Ok")},()=>{N.log("Cancel")}),H.value=!0):ue.get(route("login"))}const D=ie.messaging.isSupported()?ie.messaging():null;function F(t,d){!D||fetch("https://iid.googleapis.com/iid/v1/"+t+"/rel/topics/"+d,{method:"POST",headers:new Headers({Authorization:"key="+r.backendSetting.fcm_api_key})}).then(L=>{if(L.status<200||L.status>=400)throw"Error subscribing to topic: "+L.status+" - "+L.text();console.log('Subscribed to "'+d+'"')}).catch(L=>{console.error(L)})}async function O(){for(var t=0;t<g.value.length;t++)F(localStorage.deviceToken,g.value[t]);p.userId=_,p.catId=s,p.subCatIds=g.value,g.value=[];const d=await S.subCategoryScription(_,p);d.status==He.SUCCESS&&(await e.resetSearchSubCategoryList(_,e.paramHolder),I.value=!0,y.value.closeModal(),d.data.message=="SUBSCRIBED"?x.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{N.log("ok")}):d.data.message=="UNSUBSCIRBED"?x.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{N.log("ok")}):x.value.openModal(c("subcategory__subscription_status"),c("subcategory__subscription_message"),c("core_fe__done"),()=>{N.log("ok")}),H.value=!1,o())}function R(){f()}async function o(){b.value=[],e.subCategoryList.data.forEach(t=>{t.isSubScribe=="1"&&b.value.push(t.id+"_FE")})}async function f(){var d;y.value.closeModal(),await e.resetSearchSubCategoryList(_,e.paramHolder);const t=await S.isUserSubscribed("1",_);I.value=((d=t==null?void 0:t.data)==null?void 0:d.status)=="success",o(),y.value.closeModal(),A.value=!1}function z(){e.resetSearchSubCategoryList(_,e.paramHolder)}function q(t){if(b.value.includes(t)){let d=b.value.indexOf(t);b.value.splice(d,1)}else b.value.push(t)}function j(t){g.value=t}return de(()=>{var t;A.value==!0&&((t=e.subCategoryList)==null?void 0:t.data)==null&&y.value.closeModal()}),{updateValue:j,subCategoryStore:e,loadMore:z,subCategoryClick:q,catId:s,catName:V,currentsorting:J,sortingFilterClicked:M,activeSortingId:U,activeSortingName:B,ps_loading_dialog:y,searchClicked:R,subCatScribe:T,scribe:H,submitScribe:O,checkedSelectedList:g,subscribedSubCatList:b,success:x,ps_error_dialog:Y,ps_warning_dialog:v,appInfoStore:W,PsConst:Z,initial:A}},computed:{breadcrumb(){return[{label:c("item_list__home"),url:route("dashboard")},{label:c("sub_category_list__category"),url:route("fe_category.index")},{label:this.catName,color:"text-fePrimary-500"}]}}},ze={class:"sm:mt-32 lg:mt-36 mt-28"},qe={class:"flex flex-col sm:flex-row items-center justify-between mt-24 mb-5 sm:mb-6 lg:mb-8"},je={class:"w-full flex content-center items-center mt-7 sm:mt-0"},Ge={class:"flex-grow lg:w-72 xl:w-76 h-10 w-full sm:w-56 md:w-60"},Ke={class:"rounded-md bg-feAchromatic-50 dark:bg-feSecondary-800 shadow-xs w-44"},Ze={class:"z-30"},We=["onClick"],Ye={key:0,class:"ml-4"},Je={class:"flex flex-col"},Qe={class:"flex flex-row mb-8"},Xe={class:"w-full flex flex-col"},$e={key:0,class:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-9 lg:grid-cols-12 md:gap-6 gap-4"},eo={class:"h-44 relative flex justify-center"},oo={class:"w-14 h-14 absolute -bottom-7 bg-feAchromatic-50 p-3 items-center rounded-full border-2 border-white dark:bg-feSecondary-800 shadow-md"},to={class:"h-20"},ro={class:"absolute -top-3 -right-3 w-6 h-6"};function so(r,s,V,e,S,p){const C=i("Head"),_=i("ps-breadcrumb-2"),P=i("ps-icon"),W=i("ps-input-with-right-icon"),A=i("ps-dropdown-select"),I=i("ps-label"),y=i("ps-dropdown"),v=i("ps-button"),U=i("ps-lazy-image"),B=i("ps-route-link"),H=i("custom-checkbox"),g=i("ps-no-result"),b=i("ps-content-container"),x=i("ps-loading-dialog"),Y=i("ps-success-dialog-2"),J=i("ps-error-dialog"),Q=i("ps-warning-dialog-3");return l(),k(X,null,[a(C,{title:r.$t("sub_category_list__category")},null,8,["title"]),a(b,null,{content:u(()=>{var M,T,D,F,O,R;return[n("div",ze,[n("div",qe,[a(_,{items:p.breadcrumb,class:""},null,8,["items"]),n("div",je,[n("div",Ge,[a(W,{onKeyup:me(e.searchClicked,["enter"]),value:e.subCategoryStore.paramHolder.keyword,"onUpdate:value":s[1]||(s[1]=o=>e.subCategoryStore.paramHolder.keyword=o),class:"",placeholder:r.$t("sub_category_list__search")},{icon:u(()=>[e.subCategoryStore.paramHolder.keyword==""?(l(),h(P,{key:0,name:"search",class:"cursor-pointer"})):(l(),h(P,{key:1,onClick:s[0]||(s[0]=o=>[e.subCategoryStore.paramHolder.keyword="",e.searchClicked()]),name:"cross",class:"cursor-pointer"}))]),_:1},8,["onKeyup","value","placeholder"])]),a(y,{horizontalAlign:"right",h:"h-auto",class:"ms-4",rounded:"rounded-lg"},{select:u(()=>[a(A,{class:"h-10 w-10 sm:w-auto sm:ps-4 ps-2.5",border:"border border-1 border-feSecondary-200 dark:border-feSecondary-400",text:"text-sm font-medium text-feAchromatic-800 dark:text-feAchromatic-100 hidden lg:inline",iconTheme:"text-feAchromatic-800 ms-2 hidden lg:inline",leftIcon:"filter",leftIconTheme:"inline lg:hidden",selectedValue:e.activeSortingName,placeholder:r.$t("sort_by")},null,8,["selectedValue","placeholder"])]),list:u(()=>[n("div",Ke,[n("div",Ze,[n("div",null,[(l(!0),k(X,null,re(e.currentsorting,o=>(l(),k("div",{key:o.id,class:"w-72 flex py-4 px-2 hover:bg-fePrimary-50 dark:hover:bg-feSecondary-500 cursor-pointer items-center",onClick:f=>e.sortingFilterClicked(o)},[a(I,{class:$(["ms-2",o.id==e.activeSortingId?" font-medium":"font-light"])},{default:u(()=>[K(E(r.$t("review_entry__title"))+": "+E(o.name),1)]),_:2},1032,["class"])],8,We))),128))])])])]),_:1}),((F=(D=(T=(M=e.appInfoStore)==null?void 0:M.appInfo)==null?void 0:T.data)==null?void 0:D.psAppSetting)==null?void 0:F.isSubcatSubscription)==e.PsConst.ONE?(l(),k("div",Ye,[e.scribe?w("",!0):(l(),h(v,{key:0,padding:"p-2",onClick:e.subCatScribe},{default:u(()=>[a(P,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bell-outline",h:"24",w:"24",viewBox:"0 -2 18 23"})]),_:1},8,["onClick"])),e.scribe?(l(),h(v,{key:1,padding:"p-2",onClick:e.submitScribe},{default:u(()=>[a(P,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bluemark",h:"24",w:"24"})]),_:1},8,["onClick"])):w("",!0)])):w("",!0)])]),n("div",Je,[n("div",Qe,[n("div",Xe,[e.subCategoryStore.subCategoryList&&e.subCategoryStore.subCategoryList.data!=null?(l(),k("div",$e,[(l(!0),k(X,null,re((O=e.subCategoryStore.subCategoryList)==null?void 0:O.data,o=>(l(),k("div",{class:"relative w-full col-span-4 sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-3",key:o.id},[a(B,{class:"flex-grow",to:{name:"fe_item_list",query:{cat_id:e.catId,cat_name:e.catName,sub_cat_id:o.id,sub_cat_name:o.name,status:1}}},{default:u(()=>{var f,z,q,j;return[n("div",{class:$(["text-center cursor-pointer w-full overflow-hidden bg-feAchromatic-50 border border-feAchromatic-100 dark:border-feAchromatic-700 dark:bg-feSecondary-800 rounded-x sm:rounded-xl lg:rounded-lg hover:shadow-md",e.scribe&&e.subscribedSubCatList.filter(G=>G==o.id+"_FE").length==1?"border-2 border-fePrimary-500":""])},[n("div",eo,[a(U,{class:"transform transition duration-500 hover:scale-110 w-full h-full object-cover",src:r.$page.props.thumb3xUrl+"/"+((f=o==null?void 0:o.defaultPhoto)==null?void 0:f.imgPath),srcPlaceholder:r.$page.props.thumb1xUrl+"/"+((z=o==null?void 0:o.defaultPhoto)==null?void 0:z.imgPath),error:r.$page.props.sysImageUrl+"/default_photo.png"},null,8,["src","srcPlaceholder","error"]),n("div",oo,[a(U,{class:"transform transition duration-500 hover:scale-110",src:r.$page.props.thumb2xUrl+"/"+((q=o==null?void 0:o.defaultIcon)==null?void 0:q.imgPath),srcPlaceholder:r.$page.props.thumb1xUrl+"/"+((j=o==null?void 0:o.defaultIcon)==null?void 0:j.imgPath),error:r.$page.props.sysImageUrl+"/default_photo.png"},null,8,["src","srcPlaceholder","error"])])]),n("div",to,[a(I,{class:"peer-checked/draft:text-sky-500 pt-9 lg:text-base sm:text-sm text-base font-medium",textColor:""},{default:u(()=>[K(E(o.name.length>20?o.name.slice(0,20)+"...":o.name),1)]),_:2},1024)])],2)]}),_:2},1032,["to"]),n("div",ro,[e.scribe?(l(),h(H,{key:0,isScribe:o.isSubScribe,checked:o.id+"_FE",value:o.id+"_FE",onUpdateSelectedValue:e.updateValue,selectedValue:e.checkedSelectedList,"onUpdate:selectedValue":s[2]||(s[2]=f=>e.checkedSelectedList=f),onClick:f=>e.subCategoryClick(o.id+"_FE")},null,8,["isScribe","checked","value","onUpdateSelectedValue","selectedValue","onClick"])):w("",!0)])]))),128))])):w("",!0),e.subCategoryStore.loading.value==!1&&((R=e.subCategoryStore.subCategoryList)==null?void 0:R.data)==null&&e.initial==!1?(l(),h(g,{key:1,onOnClick:e.loadMore,class:"my-6"},null,8,["onOnClick"])):w("",!0),e.subCategoryStore.loading.value==!1&&e.initial==!1?(l(),h(v,{key:2,class:$(["w-60 mx-auto mt-8",e.subCategoryStore.isNoMoreRecord.value?"hidden":""]),onClick:e.loadMore},{default:u(()=>[K(E(r.$t("sub_category_list__load_more")),1)]),_:1},8,["onClick","class"])):e.initial==!1?(l(),h(v,{key:3,class:"w-60 mx-auto mt-8",onClick:e.loadMore,disabled:!0},{default:u(()=>[K(E(r.$t("sub_category_list__loading")),1)]),_:1},8,["onClick"])):w("",!0)])])])])]}),_:1}),a(x,{ref:"ps_loading_dialog",class:"z-40"},null,512),a(Y,{ref:"success"},null,512),a(J,{ref:"ps_error_dialog"},null,512),a(Q,{ref:"ps_warning_dialog"},null,512)],64)}var Ct=De(Re,[["render",so]]);export{Ct as default};
